<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Proyectos — Tzatzinitla</title>
  <link rel="stylesheet" href="/tzatzinitla/assets/style.css">
</head>
<body>
  <div class="container">

    <nav class="nav">
      <a href="/tzatzinitla/">Inicio</a>
      <a class="active" href="/tzatzinitla/proyectos/">Proyectos</a>
      <a href="/tzatzinitla/publicaciones/">Publicaciones</a>
      <a href="/tzatzinitla/equipo/">Equipo</a>
      <a href="/tzatzinitla/contacto/">Contacto</a>
    </nav>

    <div class="card" style="padding:22px;">
      <h1 style="margin:0 0 8px;">Proyectos</h1>
      <p class="subtitle" style="margin:0;">
        Prototipos, instrumentación y análisis de señal. Algunos proyectos incluyen telemetría en tiempo real.
      </p>
    </div>

    <div class="section">
      <h2>En vivo</h2>

      <div class="card tempCard">
        <div>
          <div class="badge"><span class="pulse"></span> Sensor activo</div>
          <div style="margin-top:10px; color:var(--muted);">Temperatura del cubículo</div>
          <div class="tempBig"><span id="temp">--</span> °C</div>
          <div style="color:var(--muted); font-size:.95rem;">
            Última actualización: <span id="time">--</span>
          </div>
        </div>
        <div style="text-align:right; color:var(--muted);">
          <div style="font-weight:700; color:var(--text);">ESP32 + sensor</div>
          <div style="margin-top:6px;">Actualiza cada 5 s</div>
          <div style="margin-top:10px;">
            <a class="btn" href="#" style="display:inline-flex;">Detalles</a>
          </div>
        </div>
      </div>

      <script>
        const CHANNEL_ID = 1234567;  // <-- tu Channel ID
        const FIELD = 1;
        const READ_KEY = "";         // opcional si el canal es privado

        async function fetchTemp() {
          try {
            const url = READ_KEY
              ? `https://api.thingspeak.com/channels/${CHANNEL_ID}/fields/${FIELD}/last.json?api_key=${READ_KEY}`
              : `https://api.thingspeak.com/channels/${CHANNEL_ID}/fields/${FIELD}/last.json`;

            const res = await fetch(url, { cache: "no-store" });
            if (!res.ok) throw new Error("HTTP " + res.status);

            const data = await res.json();
            const value = data[`field${FIELD}`];
            const created = data.created_at;

            document.getElementById("temp").textContent = value ? Number(value).toFixed(2) : "--";
            document.getElementById("time").textContent = created ? new Date(created).toLocaleString() : "--";
          } catch (e) {
            console.error(e);
          }
        }
        fetchTemp();
        setInterval(fetchTemp, 5000);
      </script>
    </div>

    <div class="section">
      <h2>Lista de proyectos</h2>
      <div class="cards">
        <div class="tile">
          <div class="title">Sensor ORP para planta de tratamiento</div>
          <p class="desc">Aqui tengo que poner de que trata el proyecto. Resultados: paper · código · datos</p>
        </div>
        <div class="tile">
          <div class="title">Antenas para RMN</div>
          <p class="desc">Aqui tengo que poner de que trata el proyecto. Resultados: paper · código · datos</p>
        </div>
        <div class="tile">
          <div class="title">Ultrasonido</div>
          <p class="desc">Aqui tengo que poner de que trata el proyecto. Resultados: paper · código · datos</p>
        </div>
        <div class="tile">
          <div class="title">FPGA</div>
          <p class="desc">2–3 líneas de qué hace. Resultados: paper · código · datos</p>
        </div>
      </div>
    </div>

    <div class="footer">© <span id="year"></span> VillarrealA · Tzatzinitla</div>
  </div>

  <script>document.getElementById("year").textContent = new Date().getFullYear();</script>
</body>
</html>

